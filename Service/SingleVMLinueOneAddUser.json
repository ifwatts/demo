{
  "service": {
    "specVersion": "v3",
    "catalog_metadata": {
      "name": "Deploy Single VM on LinuxOne and add user",
      "description": "",
      "image": "serviceicon_7.svg",
      "category": "IanDemo",
      "bullets": [],
      "providerDisplayName": "IBM",
      "longDescription": "",
      "documentationUrl": "",
      "supportUrl": "",
      "bindable": false,
      "updatable": "",
      "systemTags": true,
      "author": "Ian I.F."
    },
    "tags": [
      {
        "name": "Request_Group",
        "label": "Request_Group",
        "type": "string",
        "immutable": true,
        "hidden": false,
        "required": false,
        "secured": false,
        "description": "The current context group id of the current user that requested the provisioning of the template. This is important because a user may be part of more than one group and this identifies the context of which group the user made the request.",
        "isSystemTag": true,
        "default": "${svc_instance.group}",
        "customtype": "string",
        "permission": "Read-Only"
      },
      {
        "name": "Request_User",
        "label": "Request_User",
        "type": "string",
        "immutable": true,
        "hidden": false,
        "required": false,
        "secured": false,
        "description": "The user id of the current user that requested the provisioning of the template.",
        "isSystemTag": true,
        "default": "${svc_instance.owner}",
        "customtype": "string",
        "permission": "Read-Only"
      },
      {
        "name": "Service_Name",
        "label": "Service_Name",
        "type": "string",
        "immutable": true,
        "hidden": false,
        "required": false,
        "secured": false,
        "description": "Name provided for the service instance by the end user at time of request",
        "isSystemTag": true,
        "default": "${svc_instance.name}",
        "customtype": "string",
        "permission": "Read-Only"
      },
      {
        "name": "Service_Identifier",
        "label": "Service_Identifier",
        "type": "string",
        "immutable": true,
        "hidden": false,
        "required": false,
        "secured": false,
        "description": "Unique identifer generated by ICAM which is mapped to the service instance of the template provisioned.",
        "isSystemTag": true,
        "default": "${svc_instance.service_instance_id}",
        "customtype": "string",
        "permission": "Read-Only"
      }
    ],
    "actions": [
      {
        "type": "provision",
        "name": "Provision",
        "description": "Default action for deployment of service",
        "input_parameters": [
          {
            "name": "vm_flavour",
            "label": "VM Flavour",
            "customtype": "string",
            "type": "string",
            "immutable": false,
            "hidden": false,
            "required": false,
            "secured": false,
            "description": "Flavor of VM on Openstack",
            "options": [
              {
                "label": "LinuxONE-Medium",
                "value": "d57ba020-9b16-4365-8036-131edab4ca52",
                "default": false
              },
              {
                "label": "LinuxONE-Small",
                "value": "013022b8-1691-46ef-9dce-23529bba02df",
                "default": true
              }
            ]
          },
          {
            "name": "userid",
            "label": "User ID",
            "customtype": "password",
            "type": "password",
            "immutable": false,
            "hidden": false,
            "required": true,
            "secured": true,
            "description": "Enter the userid to be created on the vm",
            "regex": "([a-z_][a-z0-9_]{0,30})",
            "regexdesc": "a lowercase or underscore, followed by zero to thirty alphanumeric characters",
            "default": ""
          },
          {
            "name": "password",
            "label": "Password",
            "customtype": "password",
            "type": "password",
            "immutable": false,
            "hidden": false,
            "required": true,
            "secured": true,
            "description": "the password set on the system for the user",
            "regex": "^[a-z_]([a-zA-Z0-9_-]{0,31})",
            "regexdesc": "Lenght of 8 chars, starting with a lowercase or underscore, followed by 7 to thirty alphanumeric characters",
            "default": ""
          },
          {
            "name": "emailaddress",
            "label": "Email Address",
            "customtype": "string",
            "type": "string",
            "immutable": false,
            "hidden": false,
            "required": true,
            "secured": false,
            "description": "email address to which access information for the system will be provided",
            "regex": "^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\\.[a-zA-Z0-9-.]+$",
            "regexdesc": "string followed by a domain ie: name@something.com"
          },
          {
            "name": "instancename",
            "label": "Instance Name",
            "customtype": "string",
            "type": "string",
            "immutable": false,
            "hidden": false,
            "required": true,
            "secured": false,
            "description": "name of the deployed instance to be set in Openstack"
          },
          {
            "name": "project",
            "label": "",
            "customtype": "password",
            "type": "password",
            "immutable": true,
            "hidden": true,
            "required": false,
            "secured": true,
            "description": "",
            "default": "^(Y2FtMg==)"
          },
          {
            "name": "cloudconnection",
            "label": "Cloud Connection",
            "customtype": "connection",
            "type": "connection",
            "immutable": false,
            "hidden": false,
            "required": true,
            "secured": false,
            "description": "cloud access used when deploying the service",
            "default": "OpenStack-zCloud",
            "provider": "OpenStack"
          },
          {
            "name": "image_id",
            "customtype": "string",
            "type": "string",
            "immutable": true,
            "hidden": true,
            "required": false,
            "secured": false,
            "default": "d13f13ee-28de-43dc-9db2-64bad2548cd5"
          },
          {
            "name": "network",
            "label": "",
            "customtype": "string",
            "type": "string",
            "immutable": true,
            "hidden": true,
            "required": false,
            "secured": false,
            "description": "",
            "default": "ftenet"
          },
          {
            "name": "image_user",
            "label": "",
            "customtype": "password",
            "type": "password",
            "immutable": true,
            "hidden": true,
            "required": false,
            "secured": true,
            "description": "",
            "default": "^(cm9vdA==)"
          },
          {
            "name": "image_pwd",
            "label": "",
            "customtype": "password",
            "type": "password",
            "immutable": true,
            "hidden": true,
            "required": false,
            "secured": true,
            "description": "",
            "default": "^(emxpbnV4)"
          },
          {
            "name": "key_pair_name",
            "label": "Key pair name",
            "customtype": "string",
            "type": "string",
            "immutable": true,
            "hidden": true,
            "required": false,
            "secured": false,
            "description": "The name of a ssh key pair which will be injected into the instance when they are created. The key pair must already be created and associated with the tenant's account. Changing key pair name creates a new instance.",
            "default": "cam"
          }
        ],
        "flow": {
          "conditions": [],
          "templates": [
            {
              "OpenStack Single Virtual Machine demo 6d56a9": {
                "title": "OpenStack Single Virtual Machine demo 6d56a9_7c3c39",
                "template_name": "OpenStack Single Virtual Machine demo 6d56a9",
                "version": "test",
                "id": "openstac586187e0",
                "template_type": "Terraform",
                "template_content_type": "OpenStack",
                "template_provider": "OpenStack",
                "instance_name": "",
                "cloud_connection_name": "${input_parameters.cloudconnection}",
                "template_data_objects": {},
                "template_params": {
                  "openstack_image_id": "${input_parameters.image_id}",
                  "openstack_flavor_id": "${input_parameters.vm_flavour}",
                  "openstack_network_name": "${input_parameters.network}",
                  "user_id": "${input_parameters.userid}",
                  "user_pwd": "${input_parameters.password}",
                  "image_user_id": "${input_parameters.image_user}",
                  "image_user_pwd": "${input_parameters.image_pwd}",
                  "instance_name": "${input_parameters.instancename}",
                  "key_pair_name": "${input_parameters.key_pair_name}"
                },
                "outputs": [
                  "single-vm-ip",
                  "stack_id"
                ],
                "warning": false,
                "isErrorFlow": false,
                "error": false
              }
            }
          ],
          "resthooks": [],
          "notifications": [
            {
              "emailnotification": {
                "title": "emailnotification_12d1fa",
                "type": "email",
                "receiverList": "${input_parameters.emailaddress}",
                "id": "emailnotcd9f146c",
                "sender": "CAMadmin",
                "copyToList": "",
                "subject": "CONFIDENTIAL: Your System is ready",
                "body": "Your system is ready, you can access it using:\n\nssh ${input_parameters.userid}@${templates.openstac586187e0.output.single-vm-ip}\n\nPassword: ${input_parameters.password}",
                "warning": false,
                "error": false
              }
            }
          ],
          "sequence": {
            "0": "openstac586187e0",
            "1": "emailnotcd9f146c"
          },
          "error_sequence": {}
        },
        "output_parameters": []
      }
    ],
    "plans": [
      {
        "name": "Standard",
        "description": "To deploy a Standard plan",
        "actions": [],
        "plan_parameters": []
      }
    ]
  }
}